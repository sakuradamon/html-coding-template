{"version":3,"sources":["../../javascript/gallery.js"],"names":["Gallery","_target","_item_width","_margin","_placement","Placement","box_item","$","children","w","width","c","Math","floor","maxw","i","length","css","init","h","height","p","sort","getHeight","margin","item_width","column","_column","_height","Array","_count","posi_x","posi_y","no","num","max_height","max","apply","window","on","gal","update","setInterval","prepend","append"],"mappings":"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","file":"gallery.js","sourcesContent":["class Gallery {\r\n\r\n    constructor(_target,_item_width,_margin) {\r\n        this._target = _target;\r\n        this._item_width = _item_width;\r\n        this._margin = _margin;\r\n        this._placement = new Placement(this._margin);\r\n    }\r\n\r\n    update() {\r\n        let box_item = $(this._target).children();\r\n        //サイズ設定\r\n        let w = $(this._target).width();\r\n        let c = Math.floor((w - this._margin) / (this._item_width + this._margin));\r\n        if (c <= 0) {\r\n            c = 1;\r\n        }\r\n        let maxw = Math.floor((w - this._margin) / c) - this._margin;\r\n        for (var i = 0; i < box_item.length; i++){\r\n            $(box_item[i]).css({'width': maxw+'px'});\r\n        }\r\n        //初期化\r\n        this._placement.init(maxw, c);\r\n        //整列\r\n        for (var i = 0; i < box_item.length; i++){\r\n            let h = $(box_item[i]).height();\r\n            let p = this._placement.sort(h);\r\n            $(box_item[i]).css({'top': p[1]+'px', 'left': p[0]+'px', 'width': maxw+'px'});\r\n        }\r\n        //大枠の高さを調節\r\n        $(this._target).css('height', this._placement.getHeight()+this._margin+'px');\r\n    }\r\n}\r\n\r\nclass Placement {\r\n\r\n    constructor(margin) {\r\n        this._margin = margin;\r\n    }\r\n\r\n    init(item_width, column) {\r\n        this._item_width = item_width;\r\n        this._column = column;\r\n        this._height = new Array();\r\n        this._count = 0;\r\n    }\r\n\r\n    sort(height) {\r\n        let posi_x = 0;\r\n        let posi_y = 0;\r\n        let no = 0;\r\n        let num = 0;\r\n\r\n        //1列目\r\n        if (this._count < this._column) {\r\n            no = this._count;\r\n            posi_x = this._item_width * no + this._margin * (no + 1);\r\n            posi_y = this._margin;\r\n            this._height[this._count] = height + this._margin;\r\n            this._count++;\r\n            return [posi_x, posi_y];\r\n        }\r\n\r\n        //2列目以降\r\n        for (let i = 0; i < this._column; i++) {\r\n            if (i == 0 || num > this._height[i]) {\r\n                no = i;\r\n                num = this._height[i];\r\n            }\r\n        }\r\n        posi_x = this._item_width * no + this._margin * (no + 1);\r\n        posi_y = this._height[no] + this._margin;\r\n        this._height[no] = this._height[no] + height + this._margin;\r\n        this._count++;\r\n        return [posi_x, posi_y];\r\n    }\r\n\r\n    getHeight() {\r\n        let max_height = Math.max.apply(null, this._height);\r\n        if (max_height) {\r\n            return max_height;\r\n        } else {\r\n            return 0;\r\n        }\r\n    }\r\n}\r\n\r\n$(window).on('load',function(){\r\n    //要素,横幅（最低値）、margin\r\n    var gal = new Gallery('#gallery', 280, 20);\r\n    gal.update();\r\n\r\n    $(window).on('resize', function () {\r\n        gal.update();\r\n    });\r\n\r\n    setInterval(function () {\r\n        $('#gallery').prepend($('#reserve li:first'));\r\n        $('#gallery li:last').css({'top': '', 'left': '', 'width': ''});\r\n        $('#reserve').append($('#gallery li:last'));\r\n        gal.update();\r\n    }, 3000);\r\n});\r\n"]}